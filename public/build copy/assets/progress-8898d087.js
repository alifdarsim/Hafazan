import{S as l,T as c}from"./components-351c615f.js";import{a as i}from"./axiosWrapper-ce9fae6d.js";import"./axios-4a70c6fc.js";const x=(e,t)=>{l.trigger({title:"Delete Bookmark",text:"Are you sure want to delete this bookmark?"}).then(s=>{s.isConfirmed&&i.delete(`/api/bookmark/${e}`,{}).then(o=>{o.data.status==="success"&&(document.querySelectorAll(`.bookmark-button[verse-key="${t}"]`).forEach(d=>{d.querySelector("span").textContent="",d.querySelector("i").classList.remove("text-red-500","fa-solid")}),m(window.chapter),c.setText("Bookmark deleted"))})})},p=document.querySelectorAll(".read-button, .memorize-button, .unfluent-button, .bookmark-button");p.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("verse-key"),s=e.getAttribute("data-action"),o={read:"read",memorize:"memorized",unfluent:"unfluent",bookmark:"bookmarked"}[s];s==="bookmark"?l.trigger({title:"Bookmark List",html:`<div class="">
                            <div class="h-48 min-h-full flex justify-center items-center no-item">
                                 <div class="flex flex-col items-center">
                                    <div class="">
                                        <div class="text-center text-gray-400 mb-2"><i class="fa-duotone fa-bookmark-slash text-5xl"></i></div>
                                        <div class="text-center text-gray-400">No bookmark found, add new bookmark first</div>
                                    </div>
                                </div>
                            </div>
                            <div class="has-item min-h-[250px] max-h-[500px] overflow-y-auto flex flex-col gap-2"></div>
                       </div>`,cancelButtonText:"Close",confirmButtonText:"Add Bookmark",didOpen:()=>{i.get(`/api/bookmark/key/${t}`).then(a=>{const n=a.data;if(n.status==="success"){let d=n.data;if(d.length===0)document.querySelector(".has-item").classList.add("hidden");else{document.querySelector(".no-item").classList.add("hidden");let u=document.querySelector(".has-item");u.innerHTML="",d.forEach(r=>{u.innerHTML+=`<div class="bg-slate-100 dark:bg-navy-500 px-4 py-2 rounded-lg flex justify-between">
                                        <div>
                                            <div class="text-left">
                                                <span class="text-xs text-gray-400"><i class="fa-solid text-[9px] fa-user me-1"></i> ${r.user.name}</span>
                                                <span class="text-gray-400"> | </span>
                                                <span class="text-xs text-gray-400">Verse: ${r.surah}:${r.verse}</span>
                                            </div>
                                            <div class="text-sm text-left ${r.note??"dark:text-gray-500 text-[12px]"}">${r.note??"No notes"}</div>
                                        </div>
                                        <div class="flex flex-col items-center justify-center">
                                            <button data-id="${r.id}" class="bookmark-delete btn btn-sm btn-primary ps-2 pe-0"><i class="fa-solid fa-trash"></i></button>
                                        </div>
                                    </div>`}),document.querySelectorAll(".bookmark-delete").forEach(r=>{r.addEventListener("click",()=>{x(r.getAttribute("data-id"),t)})})}}})}}).then(a=>{a.isConfirmed&&l.trigger({title:"Bookmark verse",input:"textarea",inputPlaceholder:"Write your note here if any...",text:"Set a note for this verse (optional)",confirmButtonText:"Save"}).then(n=>{n.isConfirmed&&y(t,n.value)})}):l.trigger({title:`Mark as ${o}?`,text:`Mark verse (${t.split(":")[0]}) as ${o}?`}).then(a=>{a.isConfirmed&&v(t,s)})})});const v=(e,t)=>{i.post("/api/progress/store",{surah:e.split(":")[0],verse:e.split(":")[1],type:t},{}).then(s=>{const o=s.data;o.status==="success"&&(o.data.forEach(a=>k(a)),c.setText(`Verse '${e}' is marked as ${t}`))})},y=(e,t)=>{i.post("/api/bookmark/store",{surah:e.split(":")[0],verse:e.split(":")[1],note:t},{}).then(s=>{const o=s.data;o.status==="success"&&(o.data.forEach(n=>f(n)),c.setText(`Add Bookmark at verse '${e}'`))})},b=e=>{i.post("/api/progress",{surah:e},{}).then(t=>{const s=t.data;s.status==="success"&&s.data.forEach(o=>k(o))})},m=e=>{i.get(`/api/bookmark/${e}`,{}).then(t=>{const s=t.data;s.status==="success"&&s.data.forEach(a=>f(a))})},k=e=>{console.log(e);let t=document.querySelector(`.read-button[verse-key="${e.verse_key}"]`),s=document.querySelector(`.memorize-button[verse-key="${e.verse_key}"]`),o=document.querySelector(`.unfluent-button[verse-key="${e.verse_key}"]`);e.read!==0&&e.read!==void 0&&(t.querySelector("i").classList.add("text-teal-500","fa-solid"),t.querySelector("span").textContent=e.read),e.memorize!==0&&e.memorize!==void 0&&(s.querySelector("i").classList.add("text-green-500","fa-solid"),s.querySelector("span").textContent=e.memorize),e.unfluent!==0&&e.unfluent!==void 0&&(o.querySelector("i").classList.add("text-yellow-500","fa-solid"),o.querySelector("span").textContent=e.unfluent)},f=e=>{let t=document.querySelector(`.bookmark-button[verse-key="${e.verseKey}"]`);t.querySelector("span").textContent=e.count,t.querySelector("i").classList.add("text-red-500","fa-solid")};b(window.chapter);m(window.chapter);
